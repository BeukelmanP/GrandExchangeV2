<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>AuctionController.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">JaCoCoverage analysis of project &quot;GrandExchange&quot; (powered by JaCoCo from EclEmma)</a> &gt; <a href="index.source.html" class="el_package">Controllers</a> &gt; <span class="el_source">AuctionController.java</span></div><h1>AuctionController.java</h1><pre class="source lang-java linenums">/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package Controllers;

import Classes.Auctions.Auction;
import Classes.Auctions.Countdown;
import Classes.Auctions.Direct;
import Classes.Auctions.Standard;
import Classes.Auctions.StatusEnum;
import Classes.Bid;
import Classes.Grand_Exchange;
import Classes.User;
import Exceptions.NotEnoughMoneyException;
import Interfaces.IAuction;
import Interfaces.IPlaceBid;
import grandexchange.RegistryManager;
import java.net.URL;
import java.rmi.RemoteException;
import java.sql.SQLException;
import java.sql.Timestamp;
import java.util.ArrayList;
import java.util.Collections;
import java.util.ResourceBundle;
import javafx.animation.KeyFrame;
import javafx.animation.Timeline;
import javafx.beans.value.ChangeListener;
import javafx.beans.value.ObservableValue;
import javafx.event.Event;
import javafx.event.EventHandler;
import javafx.fxml.FXML;
import javafx.fxml.Initializable;
import javafx.scene.control.Button;
import javafx.scene.control.Label;
import javafx.scene.control.ProgressBar;
import javafx.scene.control.ScrollPane;
import javafx.scene.control.TextArea;
import javafx.scene.control.TextField;
import javafx.scene.image.Image;
import javafx.scene.image.ImageView;
import javafx.scene.input.MouseEvent;
import javafx.scene.layout.Pane;
import javafx.scene.text.Font;
import javafx.stage.Stage;
import javafx.util.Duration;
import javax.swing.JOptionPane;

/**
 * FXML Controller class
 *
 * @author piete
 */
<span class="nc" id="L55">public class AuctionController implements Initializable {</span>

    @FXML
    private ImageView bigProductImage;
    @FXML
    private ImageView sellerImage;
    @FXML
    private Label sellerName;
    @FXML
    private Label productTitle;
    @FXML
    private Label auctiontype;
    @FXML
    private Label productStatus;
    @FXML
    private Label countdownCurrentPrice;
    @FXML
    private Label InstabuyCurrentPrice;
    @FXML
    private Label countdownAvailableUnits;
    @FXML
    private Label instabuyTextid;
    @FXML
    private Label CreateDate;
    @FXML
    private Label lblUnits;
    @FXML
    private Label lblBid;
    @FXML
    private TextArea productDescription;
    @FXML
    private TextArea auctionDescription;
    @FXML
    private Button closeButton;
    @FXML
    private Button countdownBuyBtn;
    @FXML
    private TextField txtUnitstoBuy;
    @FXML
    private ScrollPane imagesPane;
    @FXML
    private ScrollPane recentPurchasesPane;
    @FXML
    private ProgressBar minutesBar;
    @FXML
    private Button countdownBidBuyBtn;
    @FXML
    private TextField txtUnitstoBuyBid;
    @FXML
    private TextField txtPriceToBid;
    @FXML
    private Button BidBtn;

    IAuction auctionInterface;
    IPlaceBid bid;
    Auction auction;
    Direct directAuction;
    Standard standardAuction;
    private User loggedInUser;
    private String type;
    private RegistryManager RM;

    Timeline timeline;
    int timeSeconds;

    /**
     * Initializes the controller class.
     *
     * @param url
     * @param rb
     */
    @Override
    public void initialize(URL url, ResourceBundle rb) {

<span class="nc" id="L129">    }</span>

    public void setUp(Auction auction, RegistryManager RM) {
<span class="nc" id="L132">        this.RM = RM;</span>
<span class="nc" id="L133">        this.auction = auction;</span>
<span class="nc" id="L134">        loggedInUser = RM.getUser();</span>
<span class="nc" id="L135">        productTitle.setText(auction.getProduct().getName());</span>
<span class="nc" id="L136">        productDescription.setText(auction.getProduct().getDescription());</span>
<span class="nc" id="L137">        auctionDescription.setText(auction.getDescription());</span>
<span class="nc" id="L138">        productStatus.setText(setStatus(auction.getStatus()));</span>
<span class="nc" id="L139">        int i = 0;</span>
<span class="nc" id="L140">        Pane imagePane = new Pane();</span>
<span class="nc" id="L141">        imagePane.setPrefWidth(85 * auction.getImageURLs().length);</span>
<span class="nc" id="L142">        imagePane.setPrefHeight(70);</span>
<span class="nc bnc" id="L143" title="All 2 branches missed.">        for (String URL : auction.getImageURLs()) {</span>
<span class="nc" id="L144">            ImageView image = new ImageView(new Image(URL));</span>
<span class="nc" id="L145">            image.setFitWidth(80);</span>
<span class="nc" id="L146">            image.setFitHeight(60);</span>
<span class="nc" id="L147">            image.relocate(85 * i, 5);</span>
<span class="nc" id="L148">            image.addEventHandler(MouseEvent.MOUSE_ENTERED,</span>
<span class="nc" id="L149">                    new EventHandler&lt;MouseEvent&gt;() {</span>
                @Override
                public void handle(MouseEvent e) {
<span class="nc" id="L152">                    ImageView i = (ImageView) e.getSource();</span>
<span class="nc" id="L153">                    bigProductImage.setImage(i.getImage());</span>
<span class="nc" id="L154">                }</span>
            });
<span class="nc" id="L156">            bigProductImage.setImage(new Image(auction.getImageURLs()[0]));</span>
<span class="nc" id="L157">            imagePane.getChildren().add(image);</span>
<span class="nc" id="L158">            i++;</span>
        }

<span class="nc" id="L161">        sellerImage.setImage(new Image(auction.getSeller().getImageURL()));</span>
<span class="nc" id="L162">        sellerName.setText(auction.getSeller().getUsername());</span>
<span class="nc" id="L163">        imagesPane.setContent(imagePane);</span>

        // Checks if auction has instabuy.
<span class="nc bnc" id="L166" title="All 2 branches missed.">        if (auction.isInstabuyable() == true) {</span>
<span class="nc" id="L167">            countdownBuyBtn.setDisable(false);</span>
<span class="nc" id="L168">            txtUnitstoBuy.setDisable(false);</span>

        } else {
            //countdownBuyBtn.setDisable(true);
            //txtUnitstoBuy.setDisable(true);
        }

        //Checks if auction is of instance Countdown
<span class="nc bnc" id="L176" title="All 2 branches missed.">        if (auction instanceof Countdown) {</span>
            //setting auction
<span class="nc" id="L178">            auctiontype.setText(&quot;Countdown Auction&quot;);</span>
<span class="nc" id="L179">            Countdown countdownAuction = (Countdown) auction;</span>
<span class="nc" id="L180">            countdownAuction.setPrice();</span>

            //setting buttons etc:
<span class="nc" id="L183">            txtPriceToBid.setVisible(false);</span>
<span class="nc" id="L184">            txtPriceToBid.setText(countdownAuction.getCurrentPrice() + &quot;&quot;);</span>
<span class="nc" id="L185">            BidBtn.setText(&quot;Buy&quot;);</span>
<span class="nc" id="L186">            BidBtn.relocate(121, 237);</span>
<span class="nc" id="L187">            lblBid.setVisible(false);</span>

<span class="nc" id="L189">            countdownCurrentPrice.setText(&quot;€&quot; + countdownAuction.getCurrentPrice());</span>
<span class="nc" id="L190">            InstabuyCurrentPrice.setText(&quot;€&quot; + countdownAuction.getInstabuyPrice());</span>
<span class="nc" id="L191">            long now = System.currentTimeMillis();</span>
<span class="nc" id="L192">            long then = countdownAuction.getCreationDate().getTime();</span>
<span class="nc" id="L193">            long periods_passed = (long) Math.floor(((now - then) / 1000 / 60 / (int) countdownAuction.getPriceLoweringDelay()));</span>
<span class="nc" id="L194">            long next_period_begin = ((periods_passed + 1) * 1000 * 60 * (int) countdownAuction.getPriceLoweringDelay()) + countdownAuction.getCreationDate().getTime();</span>
<span class="nc" id="L195">            Timestamp newDate = new Timestamp(next_period_begin);</span>
<span class="nc" id="L196">            CreateDate.setText(newDate.getMonth() + &quot;/&quot; + newDate.getDay() + &quot;  &quot; + newDate.getHours() + &quot;:&quot; + newDate.getMinutes() + &quot;:&quot; + newDate.getSeconds());</span>
<span class="nc" id="L197">            timeline = new Timeline();</span>
<span class="nc" id="L198">            timeline.setCycleCount(Timeline.INDEFINITE);</span>
<span class="nc" id="L199">            long duration = (next_period_begin - System.currentTimeMillis()) / 1000;</span>
<span class="nc" id="L200">            timeSeconds = (int) duration;</span>
<span class="nc" id="L201">            timeline.getKeyFrames().add(new KeyFrame(Duration.seconds(1), new EventHandler() {</span>

                @Override
                public void handle(Event event) {
<span class="nc" id="L205">                    timeSeconds--;</span>
<span class="nc" id="L206">                    int minutesToGo = (int) Math.floor(timeSeconds / 60);</span>
<span class="nc" id="L207">                    int secondsToGo = timeSeconds - (minutesToGo * 60);</span>
<span class="nc bnc" id="L208" title="All 2 branches missed.">                    if (secondsToGo &lt; 10) {</span>
<span class="nc" id="L209">                        CreateDate.setText(minutesToGo + &quot;:0&quot; + secondsToGo);</span>
                    } else {
<span class="nc" id="L211">                        CreateDate.setText(minutesToGo + &quot;:&quot; + secondsToGo);</span>
                    }
<span class="nc bnc" id="L213" title="All 2 branches missed.">                    if (minutesToGo &lt;= 0) {</span>
<span class="nc" id="L214">                        minutesBar.setProgress(-1);</span>
                    } else {
<span class="nc" id="L216">                        minutesBar.setProgress(timeSeconds / (countdownAuction.getPriceLoweringDelay() * 60));</span>
                    }
<span class="nc bnc" id="L218" title="All 2 branches missed.">                    if (timeSeconds &lt;= 0) {</span>
<span class="nc" id="L219">                        timeline.stop();</span>
<span class="nc" id="L220">                        setUp(auction, RM);</span>
                    }
<span class="nc" id="L222">                }</span>
            }));
<span class="nc" id="L224">            timeline.playFromStart();</span>

<span class="nc bnc" id="L226" title="All 2 branches missed.">            if (auction.getProductQuantity()</span>
                    &gt; 1) {
<span class="nc" id="L228">                countdownAvailableUnits.setText(&quot;There are &quot; + auction.getProductQuantity() + &quot; units available&quot;);</span>
<span class="nc bnc" id="L229" title="All 2 branches missed.">            } else if (auction.getProductQuantity()</span>
                    == 1) {
<span class="nc" id="L231">                countdownAvailableUnits.setText(&quot;There is just 1 item left&quot;);</span>
<span class="nc bnc" id="L232" title="All 2 branches missed.">            } else if (auction.getProductQuantity()</span>
                    == 0) {
<span class="nc" id="L234">                countdownAvailableUnits.setText(&quot;There are no items left, you missed it&quot;);</span>
            }

<span class="nc" id="L237">            setCountdownBuys(auction);</span>

        }

<span class="nc bnc" id="L241" title="All 2 branches missed.">        if (auction instanceof Standard) {</span>
            //setting correct buttons:           
<span class="nc" id="L243">            txtUnitstoBuyBid.setVisible(false);</span>
<span class="nc" id="L244">            txtUnitstoBuyBid.setText(&quot;1&quot;);</span>
<span class="nc" id="L245">            lblUnits.setVisible(false);</span>

<span class="nc" id="L247">            this.type = &quot;standard&quot;;</span>
<span class="nc" id="L248">            this.minutesBar.setVisible(false);</span>
<span class="nc" id="L249">            auctiontype.setText(&quot;Standard Auction&quot;);</span>
<span class="nc" id="L250">            standardAuction = (Standard) auction;</span>
<span class="nc" id="L251">            countdownCurrentPrice.setText(&quot;€&quot; + standardAuction.getCurrentPrice());</span>
<span class="nc" id="L252">            InstabuyCurrentPrice.setText(&quot;€&quot; + standardAuction.getInstabuyPrice());</span>

<span class="nc" id="L254">            Timestamp newDate = standardAuction.getCreationDate();</span>
<span class="nc" id="L255">            CreateDate.setText(newDate.getMonth() + &quot;/&quot; + newDate.getDay() + &quot;  &quot; + newDate.getHours() + &quot;:&quot; + newDate.getMinutes() + &quot;:&quot; + newDate.getSeconds());</span>

<span class="nc bnc" id="L257" title="All 2 branches missed.">            if (auction.getProductQuantity()</span>
                    &gt;= 1) {
<span class="nc" id="L259">                countdownAvailableUnits.setText(&quot;You're Buying &quot; + auction.getProductQuantity() + &quot; units for this price!&quot;);</span>
            }

<span class="nc" id="L262">            setCountdownBuys(auction);</span>

        }

<span class="nc bnc" id="L266" title="All 2 branches missed.">        if (auction instanceof Direct) {</span>
<span class="nc" id="L267">            this.type = &quot;direct&quot;;</span>
<span class="nc" id="L268">            auctiontype.setText(&quot;Direct Auction&quot;);</span>
<span class="nc" id="L269">            directAuction = (Direct) auction;</span>
<span class="nc" id="L270">            countdownCurrentPrice.setText(&quot;€&quot; + directAuction.getCurrentPrice());</span>
<span class="nc" id="L271">            InstabuyCurrentPrice.setText(&quot;€&quot; + directAuction.getInstabuyPrice());</span>

<span class="nc" id="L273">            Timestamp newDate = directAuction.getCreationDate();</span>
<span class="nc" id="L274">            CreateDate.setText(newDate.getMonth() + &quot;/&quot; + newDate.getDay() + &quot;  &quot; + newDate.getHours() + &quot;:&quot; + newDate.getMinutes() + &quot;:&quot; + newDate.getSeconds());</span>

<span class="nc bnc" id="L276" title="All 2 branches missed.">            if (auction.getProductQuantity()</span>
                    &gt; 1) {
<span class="nc" id="L278">                countdownAvailableUnits.setText(&quot;There are &quot; + auction.getProductQuantity() + &quot; units available&quot;);</span>
<span class="nc bnc" id="L279" title="All 2 branches missed.">            } else if (auction.getProductQuantity()</span>
                    == 1) {
<span class="nc" id="L281">                countdownAvailableUnits.setText(&quot;There is just 1 item left&quot;);</span>
<span class="nc bnc" id="L282" title="All 2 branches missed.">            } else if (auction.getProductQuantity()</span>
                    == 0) {
<span class="nc" id="L284">                countdownAvailableUnits.setText(&quot;There are no items left, you missed it&quot;);</span>
            }

<span class="nc" id="L287">            setCountdownBuys(auction);</span>

        }

<span class="nc" id="L291">        txtUnitstoBuy.textProperty().addListener(new ChangeListener&lt;String&gt;() {</span>
            @Override
            public void changed(ObservableValue&lt;? extends String&gt; observable, String oldValue, String newValue) {
<span class="nc bnc" id="L294" title="All 2 branches missed.">                if (!newValue.matches(&quot;\\d*&quot;)) {</span>
<span class="nc" id="L295">                    txtUnitstoBuy.setText(newValue.replaceAll(&quot;[^\\d]&quot;, &quot;&quot;));</span>
                }
<span class="nc" id="L297">            }</span>
        });
<span class="nc" id="L299">    }</span>

    /**
     * Returns textual status
     * @param status StatusEnum
     * @return 
     */
    public String setStatus(StatusEnum status) {
<span class="nc bnc" id="L307" title="All 7 branches missed.">        switch (status) {</span>
            case New:
<span class="nc" id="L309">                return &quot;New&quot;;</span>
            case GoodAsNew:
<span class="nc" id="L311">                return &quot;As good as new&quot;;</span>
            case Refurbished:
<span class="nc" id="L313">                return &quot;Refurbished&quot;;</span>
            case Used_Good:
<span class="nc" id="L315">                return &quot;little damage(small dents)&quot;;</span>
            case Used_Bad:
<span class="nc" id="L317">                return &quot;annoying damage(Cracks)&quot;;</span>
            case Broken:
<span class="nc" id="L319">                return &quot;not fully functional or Broken&quot;;</span>
            default:
<span class="nc" id="L321">                return &quot;&quot;;</span>
        }
    }

    public void countdownBuyButtonClick() throws SQLException, RemoteException {

<span class="nc" id="L327">        RM.getPlaceBidInterface();</span>
<span class="nc" id="L328">        this.bid = RM.getBid();</span>
        
<span class="nc bnc" id="L330" title="All 6 branches missed.">        if (Integer.parseInt(txtUnitstoBuy.getText()) &lt;= auction.getProductQuantity() &amp;&amp; Integer.parseInt(txtUnitstoBuy.getText()) &gt; 0 &amp;&amp; auction != null) {</span>
<span class="nc" id="L331">            double totalPrice = Double.parseDouble(txtUnitstoBuy.getText()) * auction.getInstabuyPrice();</span>

<span class="nc" id="L333">            int reply = JOptionPane.showConfirmDialog(null, &quot;Are you sure you want to buy &quot; + txtUnitstoBuy.getText() + &quot;\nitems with the price of: €&quot; + auction.getInstabuyPrice() + &quot; a item \nand a total of: €&quot; + totalPrice, &quot;Are you sure?&quot;, JOptionPane.YES_NO_OPTION);</span>
<span class="nc bnc" id="L334" title="All 2 branches missed.">            if (reply == JOptionPane.YES_OPTION) {</span>
<span class="nc bnc" id="L335" title="All 2 branches missed.">                for (int i = 0; i &lt; Integer.parseInt(txtUnitstoBuy.getText()); i++) {</span>
<span class="nc" id="L336">                    auctionInterface.InstabuyItem(Integer.valueOf(txtUnitstoBuy.getText()), auction.getId(), loggedInUser.getUserID());</span>
                }
<span class="nc" id="L338">                auction.setProductQuantity(Integer.parseInt(txtUnitstoBuy.getText()));</span>
<span class="nc" id="L339">                setCountdownBuys(auction);</span>
<span class="nc" id="L340">                auctionInterface.updateAuction(auction);</span>
<span class="nc bnc" id="L341" title="All 2 branches missed.">                if (auction.getProductQuantity() &gt; 1) {</span>
<span class="nc" id="L342">                    countdownAvailableUnits.setText(&quot;There are &quot; + auction.getProductQuantity() + &quot; units available&quot;);</span>
<span class="nc bnc" id="L343" title="All 2 branches missed.">                } else if (auction.getProductQuantity() == 1) {</span>
<span class="nc" id="L344">                    countdownAvailableUnits.setText(&quot;There is just 1 item left&quot;);</span>
<span class="nc bnc" id="L345" title="All 2 branches missed.">                } else if (auction.getProductQuantity() == 0) {</span>
<span class="nc" id="L346">                    countdownAvailableUnits.setText(&quot;There are no items left, you missed it&quot;);</span>
                }
            } else {
<span class="nc" id="L349">                JOptionPane.showMessageDialog(null, &quot;Canceled&quot;);</span>
            }
<span class="nc bnc" id="L351" title="All 2 branches missed.">        } else if (Integer.parseInt(txtUnitstoBuy.getText()) &lt;= 0) {</span>
<span class="nc" id="L352">            JOptionPane.showMessageDialog(null, &quot;You can't buy less than 1 object&quot;);</span>
        } else {
<span class="nc" id="L354">            JOptionPane.showMessageDialog(null, &quot;You can't buy more objects than there are available&quot;);</span>
        }
<span class="nc" id="L356">    }</span>

    // TODO: aanpassen dat het het tweede textveld goed erin zet.
    public void bidBuyButtonClick() throws SQLException, RemoteException, NotEnoughMoneyException {

<span class="nc" id="L361">        RM.getPlaceBidInterface();</span>
<span class="nc" id="L362">        this.bid = RM.getBid();</span>
        
<span class="nc bnc" id="L364" title="All 6 branches missed.">        if (Integer.parseInt(txtUnitstoBuyBid.getText()) &lt;= auction.getProductQuantity() &amp;&amp; Integer.parseInt(txtUnitstoBuyBid.getText()) &gt; 0 &amp;&amp; auction != null) {</span>
<span class="nc" id="L365">            double totalPrice = Double.parseDouble(txtUnitstoBuyBid.getText()) * auction.getCurrentPrice();</span>
<span class="nc" id="L366">            double unitsToBuy = Double.parseDouble(txtUnitstoBuyBid.getText());</span>
<span class="nc" id="L367">            double bedrag = Double.parseDouble(txtPriceToBid.getText());</span>

            //int getal = Integer.parseInt(txtUnitstoBuy.getText());
<span class="nc bnc" id="L370" title="All 2 branches missed.">            if (Double.parseDouble(txtPriceToBid.getText()) &gt; auction.getCurrentPrice()) {</span>
<span class="nc" id="L371">                auction.addBid(new Bid(auction.getId(), RM.getUser(), Double.parseDouble(txtPriceToBid.getText()))); // adds bid to auction</span>
<span class="nc bnc" id="L372" title="All 2 branches missed.">                if (bid.placeBid(unitsToBuy, auction.getId(), loggedInUser.getUserID(), bedrag)) {</span>
<span class="nc" id="L373">                    System.out.println(&quot;Correct geinsert&quot;);</span>
                } else {
<span class="nc" id="L375">                    System.out.println(&quot;FAILED&quot;);</span>
                }
<span class="nc" id="L377">                System.out.println(&quot;Units To buy: &quot; + unitsToBuy);</span>
<span class="nc" id="L378">                System.out.println(&quot;Auction ID : &quot; + auction.getId());</span>
<span class="nc" id="L379">                System.out.println(&quot;User ID : &quot; + loggedInUser.getUserID());</span>
<span class="nc" id="L380">                System.out.println(&quot;Price To pay: &quot; + bedrag);</span>
<span class="nc" id="L381">                auction.setCurrentPrice(Double.parseDouble(txtPriceToBid.getText()));</span>
<span class="nc" id="L382">                countdownCurrentPrice.setText(&quot;€&quot; + Double.parseDouble(txtPriceToBid.getText()));</span>

            }

            //Voegt bid to aan de auction
            //GX.addBid(Double.valueOf(txtUnitstoBuy.getText()), auction.getId(), loggedInUser.getUserID(),auction.getCurrentPrice());
            //auction.setProductQuantity(Integer.parseInt(txtUnitstoBuyBid.getText()));
<span class="nc" id="L389">            setCountdownBuys(auction);</span>
<span class="nc" id="L390">            auctionInterface.updateAuction(auction);</span>
<span class="nc bnc" id="L391" title="All 2 branches missed.">            if (auction.getProductQuantity() &gt; 1) {</span>
<span class="nc" id="L392">                countdownAvailableUnits.setText(&quot;There are &quot; + auction.getProductQuantity() + &quot; units available&quot;);</span>
<span class="nc bnc" id="L393" title="All 2 branches missed.">            } else if (auction.getProductQuantity() == 1) {</span>
<span class="nc" id="L394">                countdownAvailableUnits.setText(&quot;There is just 1 item left&quot;);</span>
<span class="nc bnc" id="L395" title="All 2 branches missed.">            } else if (auction.getProductQuantity() == 0) {</span>
<span class="nc" id="L396">                countdownAvailableUnits.setText(&quot;There are no items left, you missed it&quot;);</span>
            }
<span class="nc bnc" id="L398" title="All 2 branches missed.">        } else if (Integer.parseInt(txtUnitstoBuyBid.getText()) &lt;= 0) {</span>
<span class="nc" id="L399">            JOptionPane.showMessageDialog(null, &quot;You can't buy less than 1 object&quot;);</span>
        } else {
<span class="nc" id="L401">            JOptionPane.showMessageDialog(null, &quot;You can't buy more objects than there are available&quot;);</span>
        }
<span class="nc" id="L403">    }</span>

    public void setCountdownBuys(Auction auction) {
<span class="nc" id="L406">        Pane BuyPane = new Pane();</span>
<span class="nc" id="L407">        BuyPane.setPrefWidth(371);</span>
<span class="nc" id="L408">        BuyPane.setPrefHeight(75 * auction.getBids().size());</span>
<span class="nc" id="L409">        int a = 0;</span>
<span class="nc" id="L410">        ArrayList&lt;Bid&gt; bids = auction.getBids();</span>
<span class="nc" id="L411">        Collections.reverse(bids);</span>
<span class="nc bnc" id="L412" title="All 2 branches missed.">        for (Bid b : bids) {</span>
<span class="nc" id="L413">            Pane p = new Pane();</span>
<span class="nc" id="L414">            p.setPrefHeight(75);</span>
<span class="nc" id="L415">            p.setPrefWidth(371);</span>
<span class="nc" id="L416">            p.relocate(0, a * 75);</span>
<span class="nc bnc" id="L417" title="All 2 branches missed.">            if ((a % 2) == 0) {</span>
<span class="nc" id="L418">                p.setStyle(&quot;-fx-background-color: lightgrey &quot;);</span>
            }
<span class="nc" id="L420">            Label name = new Label();</span>
<span class="nc" id="L421">            name.setText(b.getPlacerUsername());</span>
<span class="nc" id="L422">            name.setFont(new Font(&quot;Arial&quot;, 17));</span>
<span class="nc" id="L423">            Label price = new Label();</span>
<span class="nc" id="L424">            price.setText(&quot;Bought at a price of: €&quot; + b.getAmount());</span>
<span class="nc" id="L425">            price.setFont(new Font(&quot;Arial&quot;, 14));</span>
<span class="nc" id="L426">            name.relocate(10, 15);</span>
<span class="nc" id="L427">            price.relocate(10, 45);</span>
<span class="nc" id="L428">            p.getChildren().addAll(price, name);</span>
<span class="nc" id="L429">            BuyPane.getChildren().add(p);</span>
<span class="nc" id="L430">            a++;</span>
<span class="nc" id="L431">        }</span>
<span class="nc" id="L432">        recentPurchasesPane.setContent(BuyPane);</span>
<span class="nc" id="L433">    }</span>

    @FXML
    private void closeButtonClick() {
<span class="nc" id="L437">        Stage stage = (Stage) closeButton.getScene().getWindow();</span>
<span class="nc" id="L438">        stage.close();</span>
<span class="nc" id="L439">    }</span>

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.6.201602180812</span></div></body></html>